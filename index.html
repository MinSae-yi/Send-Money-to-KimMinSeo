<!DOCTYPE html>

<html lang="ko">



<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>내 계좌 & 은행 앱 실행</title>

  <style>

    body {

      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

      background: #f5f7fa;

      margin: 0;

      padding: 2rem;

      display: flex;

      flex-direction: column;

      align-items: center;

      gap: 2rem;

    }



    #instaWarning {

      display: none;

      background: #fffae6;

      border: 1px solid #ffd42a;

      padding: 1rem 1.5rem;

      border-radius: 6px;

      color: #665500;

      font-size: 0.9rem;

      max-width: 320px;

      text-align: center;

    }



    .account-section {

      background: #fff;

      padding: 1.5rem 2rem;

      border-radius: 8px;

      box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);

      text-align: center;

      width: 320px;

      max-width: 100%;

    }



    .account-number {

      font-size: 1.4rem;

      font-weight: bold;

      margin-bottom: 0.6rem;

      user-select: all;

    }



    .account-name {

      font-size: 1.2rem;

      margin-bottom: 0.6rem;

      color: #555;

    }



    .bank-name {

      font-size: 0.9rem;

      color: #888;

      margin-bottom: 1.2rem;

    }



    button.copy-btn,

    button.query-btn {

      background-color: #4caf50;

      border: none;

      color: white;

      padding: 0.4rem 0.8rem;

      border-radius: 5px;

      cursor: pointer;

      font-size: 0.85rem;

      transition: background-color 0.3s;

      width: 100%;

      margin-bottom: 0.5rem;

    }



    button.copy-btn:hover,

    button.query-btn:hover {

      background-color: #45a049;

    }



    .banks-panel {

      display: flex;

      flex-direction: column;

      gap: 0.4rem;

      width: 320px;

      max-width: 100%;

    }



    .bank-btn {

      display: inline-block;

      text-decoration: none;

      padding: 0.6rem 0.1rem;

      border-radius: 6px;

      font-size: 0.85rem;

      font-weight: 600;

      text-align: center;

      width: 100%;

      box-sizing: border-box;

      color: white;

      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);

      white-space: nowrap;

      overflow: hidden;

      text-overflow: ellipsis;

      cursor: pointer;

      user-select: none;

    }



    .kakao { background-color: #feda00; color: #3c1e1e; }

    .toss { background-color: #0077cc; }

    .kookmin { background-color: #d4af00; color: #000; }

    .hana { background-color: #b2e2b2; color: #000; }

    .woori { background-color: #0055aa; }

    .shinhan { background-color: #003366; }

    .nonghyup { background-color: #4caf50; }



    .bank-btn:hover {

      opacity: 0.85;

    }

  </style>

</head>



<body>



  <div id="instaWarning">

    ⚠️ 인스타그램 내장 브라우저에서는 은행 앱 실행이 원활하지 않거나 자동 복사가 제한될 수 있습니다.<br />

    앱이 바로 열리지 않으면, 계좌번호 복사 후 해당 은행 앱을 직접 실행해 주세요.<br />

    또는 '외부 브라우저로 열기' 기능이 있다면 사용해 보세요.

  </div>



  <section class="account-section">

    <div class="account-number" id="accountNumber">94900200430797</div>

    <div class="account-name">김민서</div>

    <div class="bank-name">(국민)</div>

    <button class="copy-btn" onclick="copyAccount()">계좌번호 복사</button>

    <button class="query-btn" onclick="callAccountListAPI()">전체 계좌 조회</button>

  </section>



  <section class="banks-panel">

    <div class="bank-btn kakao" onclick="openApp('kakaobank://', 'https://play.google.com/store/apps/details?id=com.kakaobank.channel', 'https://apps.apple.com/kr/app/id1156582303')" role="button" tabindex="0">카카오</div>

    <div class="bank-btn toss" onclick="openApp('supertoss://', 'https://play.google.com/store/apps/details?id=viva.republica.toss', 'https://apps.apple.com/kr/app/id839333328')" role="button" tabindex="0">토스뱅크</div>

    <div class="bank-btn kookmin" onclick="openKookminBank()" role="button" tabindex="0">국민</div>

    <div class="bank-btn hana" onclick="openApp('hana1qbank://', 'https://play.google.com/store/apps/details?id=com.hanabank.ebk.channel.android.hananbank', 'https://apps.apple.com/kr/app/id362052830')" role="button" tabindex="0">하나</div>

    <div class="bank-btn woori" onclick="openApp('com.wooricard.wcard://', 'https://play.google.com/store/apps/details?id=com.wooricard.wcard', 'https://apps.apple.com/kr/app/id400866312')" role="button" tabindex="0">우리</div>

    <div class="bank-btn shinhan" onclick="openApp('cloudpay://', 'https://play.google.com/store/apps/details?id=com.shcard.smartpay', 'https://apps.apple.com/kr/app/id1109689743')" role="button" tabindex="0">신한</div>

    <div class="bank-btn nonghyup" onclick="openNHKokBank()" role="button" tabindex="0">농협</div>

  </section>



  <script>

    const accountNumberEl = document.getElementById('accountNumber');

    const accountNumber = accountNumberEl ? accountNumberEl.innerText : '';

    const instaWarning = document.getElementById('instaWarning');

    

    const userAgent = navigator.userAgent || navigator.vendor || window.opera;

    const isInstagram = userAgent.includes('Instagram');

    const isIOS = /iPhone|iPad|iPod/i.test(userAgent);

    const isAndroid = /Android/i.test(userAgent);



    if (isInstagram) {

      instaWarning.style.display = 'block';

    }



    function fallbackCopyTextToClipboard(text, showFeedback) {

      const textArea = document.createElement("textarea");

      textArea.value = text;

      textArea.style.position = "fixed";

      textArea.style.top = "-9999px";

      textArea.style.left = "-9999px";

      textArea.style.opacity = "0";

      textArea.style.pointerEvents = "none";

      document.body.appendChild(textArea);

      textArea.focus();

      textArea.select();

      let successful = false;

      try {

        successful = document.execCommand('copy');

        if (successful && showFeedback) alert('계좌번호가 복사되었습니다! (Fallback)');

        else if (!successful && showFeedback) alert('복사에 실패했습니다. 수동으로 복사해주세요.');

      } catch (err) {

        if (showFeedback) alert('복사에 실패했습니다. 수동으로 복사해주세요.');

        console.error('Fallback: Error executing document.execCommand("copy"):', err);

      }

      document.body.removeChild(textArea);

      return successful;

    }



    function copyAccount(showFeedback = true) {

      const textToCopy = accountNumber;

      if (!textToCopy) {

          if(showFeedback) alert('복사할 계좌번호가 없습니다.');

          return Promise.resolve(false);

      }

      return new Promise((resolve) => {

        if (navigator.clipboard && navigator.clipboard.writeText) {

          navigator.clipboard.writeText(textToCopy).then(() => {

            if (showFeedback) alert('계좌번호가 복사되었습니다!');

            resolve(true);

          }).catch(err => {

            console.warn('navigator.clipboard.writeText failed, trying execCommand fallback:', err);

            resolve(fallbackCopyTextToClipboard(textToCopy, showFeedback));

          });

        } else {

          console.warn('navigator.clipboard API not available, trying execCommand fallback.');

          resolve(fallbackCopyTextToClipboard(textToCopy, showFeedback));

        }

      });

    }



    function openApp(scheme, androidUrl, iosUrl) {

      copyAccount(false); 

      

      const fallbackUrl = isIOS ? iosUrl : androidUrl;

      const now = Date.now();

      const timeout = isIOS ? 2500 : 1200; // iOS는 앱 전환 감지에 더 긴 시간을 줄 수 있습니다.



      window.location.href = scheme;



      setTimeout(() => {

        // 앱으로 전환되었다면 document.hidden은 true가 됩니다.

        // 페이지가 여전히 보이고(hidden이 아니고), 충분한 시간이 지나지 않았다면 스토어로 이동합니다.

        if (!document.hidden && (Date.now() - now < timeout + 500)) {

          window.location.href = fallbackUrl;

        }

      }, timeout);

    }



    function openNHKokBank() {

      copyAccount(false); 



      const nhIntentUrl = 'intent://nh.smart.nhcok#Intent;scheme=nhcok;package=nh.smart.nhcok;end';

      const playStoreUrl = 'https://play.google.com/store/apps/details?id=nh.smart.nhcok';

      const appStoreUrl = 'https://apps.apple.com/kr/app/id1131147442'; 

      const nhIosScheme = 'nhbank://'; // NH콕뱅크의 iOS URL 스킴 (예시, 실제 스킴 확인 필요)



      const now = Date.now();

      const timeout = isIOS ? 2500 : 1200;



      if (isAndroid) {

        window.location.href = nhIntentUrl;

        setTimeout(() => {

          if (!document.hidden && (Date.now() - now < timeout + 500)) {

            window.location.href = playStoreUrl;

          }

        }, timeout);

      } else if (isIOS) {

        // NH콕뱅크도 iOS 스킴을 먼저 시도합니다.

        window.location.href = nhIosScheme; 

        setTimeout(() => {

          if (!document.hidden && (Date.now() - now < timeout + 500)) {

            window.location.href = appStoreUrl; // 실패 시 스토어로

          }

        }, timeout);

      } else {

        alert('지원되지 않는 플랫폼입니다.');

      }

    }



    function openKookminBank() {

      copyAccount(false); 

      

      const kookminAndroidIntent = 'intent://open#Intent;scheme=kb-acp;package=com.kbstar.kbbank;end';

      const kookminIosScheme = 'kbstarbanks://'; // KB스타뱅킹 최신 iOS URL Scheme

      const playStoreUrl = 'https://play.google.com/store/apps/details?id=com.kbstar.kbbank';

      const appStoreUrl = 'https://apps.apple.com/kr/app/id361508560';



      const now = Date.now();

      // iOS의 경우 앱 전환 감지를 위해 timeout을 조금 더 길게 설정 (예: 2.5초)

      const timeout = isIOS ? 2500 : 1200; 



      let appSchemeToTry;

      let fallbackStoreUrl;



      if (isAndroid) {

        appSchemeToTry = kookminAndroidIntent;

        fallbackStoreUrl = playStoreUrl;

      } else if (isIOS) {

        appSchemeToTry = kookminIosScheme;

        fallbackStoreUrl = appStoreUrl;

      } else {

        alert('지원되지 않는 플랫폼입니다.');

        return;

      }



      window.location.href = appSchemeToTry;



      setTimeout(() => {

        // `document.hidden`이 true면 앱으로 전환된 것으로 간주하고 스토어로 보내지 않음

        // 페이지가 여전히 보이고(hidden이 아니고), 충분한 시간이 지나지 않았다면 스토어로 이동

        if (!document.hidden && (Date.now() - now < timeout + 500)) { 

          window.location.href = fallbackStoreUrl;

        }

      }, timeout);

    }



    function callAccountListAPI() {

      fetch('/v1/corpbank/apis/wholAcnLstInquery', {

        method: 'POST',

        headers: {

          'Content-Type': 'application/json',

          'Authorization': 'Bearer YOUR_ACCESS_TOKEN' 

        },

        body: JSON.stringify({

          organizationCode: 'ORG12345',

          userId: 'USER67890'

        })

      })

        .then(response => {

          if (!response.ok) {

            throw new Error(`HTTP error! status: ${response.status}`);

          }

          return response.json();

        })

        .then(data => {

          console.log('조회 결과:', data);

          alert('전체 계좌 목록 조회 완료 (콘솔 확인)');

        })

        .catch(error => {

          console.error('조회 실패:', error);

          alert(`계좌 목록 조회 중 오류 발생: ${error.message}`);

        });

    }

  </script>



</body>

</html>
